local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.Name = "BlueExecutor"
gui.ResetOnSpawn = false

-- MAIN FRAME
local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 600, 0, 400)
frame.Position = UDim2.new(0.5, -300, 0.5, -200)
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true

-- TOP BAR
local topBar = Instance.new("Frame", frame)
topBar.Size = UDim2.new(1, 0, 0, 30)
topBar.BackgroundColor3 = Color3.fromRGB(35, 35, 55)
topBar.BorderSizePixel = 0

local title = Instance.new("TextLabel", topBar)
title.Text = "Blue Executor"
title.Font = Enum.Font.Code
title.TextColor3 = Color3.fromRGB(160, 160, 160)
title.TextSize = 16
title.TextXAlignment = Enum.TextXAlignment.Left
title.Size = UDim2.new(1, -60, 1, 0)
title.Position = UDim2.new(0, 35, 0, 0)
title.BackgroundTransparency = 1

-- MINIMIZE BUTTON
local minimize = Instance.new("TextButton", topBar)
minimize.Text = "v"
minimize.Size = UDim2.new(0, 30, 1, 0)
minimize.Position = UDim2.new(0, 0, 0, 0)
minimize.BackgroundColor3 = Color3.fromRGB(40, 40, 80)
minimize.TextColor3 = Color3.new(1, 1, 1)
minimize.Font = Enum.Font.Code
minimize.TextSize = 18
minimize.BorderSizePixel = 0

-- SCROLLING TEXTBOX FRAME
local scroll = Instance.new("ScrollingFrame", frame)
scroll.Position = UDim2.new(0, 10, 0, 40)
scroll.Size = UDim2.new(1, -20, 1, -90)
scroll.BackgroundColor3 = Color3.fromRGB(35, 35, 55)
scroll.BorderSizePixel = 0
scroll.ScrollBarThickness = 8
scroll.CanvasSize = UDim2.new(0, 0, 0, 0)

-- TEXTBOX
local textbox = Instance.new("TextBox", scroll)
textbox.Size = UDim2.new(0, 1200, 0, 1000)
textbox.BackgroundTransparency = 1
textbox.TextXAlignment = Enum.TextXAlignment.Left
textbox.TextYAlignment = Enum.TextYAlignment.Top
textbox.Font = Enum.Font.Code
textbox.TextSize = 16
textbox.TextColor3 = Color3.fromRGB(220, 220, 220)
textbox.ClearTextOnFocus = false
textbox.MultiLine = true
textbox.TextWrapped = false
textbox.Text = "-- Your script here"

-- Auto-update scroll canvas size
textbox:GetPropertyChangedSignal("Text"):Connect(function()
	local bounds = textbox.TextBounds
	scroll.CanvasSize = UDim2.new(0, bounds.X + 20, 0, bounds.Y + 20)
end)

-- EXECUTE BUTTON
local execute = Instance.new("TextButton", frame)
execute.Size = UDim2.new(0, 80, 0, 30)
execute.Position = UDim2.new(1, -180, 1, -35)
execute.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
execute.Text = "Execute"
execute.Font = Enum.Font.Code
execute.TextSize = 16
execute.TextColor3 = Color3.new(1, 1, 1)
execute.BorderSizePixel = 0

-- CLEAR BUTTON
local clear = Instance.new("TextButton", frame)
clear.Size = UDim2.new(0, 80, 0, 30)
clear.Position = UDim2.new(1, -90, 1, -35)
clear.BackgroundColor3 = Color3.fromRGB(0, 100, 220)
clear.Text = "Clear"
clear.Font = Enum.Font.Code
clear.TextSize = 16
clear.TextColor3 = Color3.new(1, 1, 1)
clear.BorderSizePixel = 0

-- RESIZER
local resizeHandle = Instance.new("Frame", frame)
resizeHandle.Size = UDim2.new(0, 20, 0, 20)
resizeHandle.Position = UDim2.new(1, -20, 1, -20)
resizeHandle.BackgroundColor3 = Color3.fromRGB(50, 50, 80)
resizeHandle.BorderSizePixel = 0
resizeHandle.Active = true

-- RESIZE LOGIC
local resizing = false
resizeHandle.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		resizing = true
	end
end)
UserInputService.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		resizing = false
	end
end)
UserInputService.InputChanged:Connect(function(input)
	if resizing and input.UserInputType == Enum.UserInputType.MouseMovement then
		local mouse = UserInputService:GetMouseLocation()
		local rel = gui:ScreenToGuiPosition(mouse)
		local newWidth = math.clamp(rel.X - frame.AbsolutePosition.X, 200, 1000)
		local newHeight = math.clamp(rel.Y - frame.AbsolutePosition.Y, 150, 800)
		frame.Size = UDim2.new(0, newWidth, 0, newHeight)
	end
end)

-- EXECUTE CODE
execute.MouseButton1Click:Connect(function()
	local code = textbox.Text
	local func, err = loadstring(code)
	if func then
		pcall(func)
	else
		warn("Error:", err)
	end
end)

-- CLEAR TEXTBOX
clear.MouseButton1Click:Connect(function()
	textbox.Text = ""
end)

-- MINIMIZE TOGGLE
local minimized = false
minimize.MouseButton1Click:Connect(function()
	minimized = not minimized
	scroll.Visible = not minimized
	execute.Visible = not minimized
	clear.Visible = not minimized
	resizeHandle.Visible = not minimized
	minimize.Text = minimized and ">" or "v"
end)

-- INSERT KEY TOGGLE GUI
local guiVisible = true
UserInputService.InputBegan:Connect(function(input, gpe)
	if not gpe and input.KeyCode == Enum.KeyCode.Insert then
		guiVisible = not guiVisible
		gui.Enabled = guiVisible
	end
end)
